



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="blog_dxm" href="http://example.com/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="blog_dxm" href="http://example.com/atom.xml" />
<link rel="alternate" type="application/json" title="blog_dxm" href="http://example.com/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="Linux,Vim,GDB,Git" />


<link rel="canonical" href="http://example.com/2024/04/25/note/tutorial_linux/">



  <title>
Tutorial-Linux - Linux - Note |
DDD = blog_dxm</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Tutorial-Linux
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2024-04-25 21:12:10">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2024-04-25T21:12:10+08:00">2024-04-25</time>
  </span>
  <span class="item" title="Symbols count in article">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">Symbols count in article</span>
    <span>35k</span>
    <span class="text">words</span>
  </span>
  <span class="item" title="Reading time">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">Reading time</span>
    <span>32 mins.</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">DDD</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="/2024/04/25/note/tutorial_linux/wp_0002.png">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span><i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/note/" itemprop="item" rel="index" title="In Note"><span itemprop="name">Note</span></a>
<meta itemprop="position" content="1" /></span>
<i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/note/Linux/" itemprop="item" rel="index" title="In Linux"><span itemprop="name">Linux</span></a>
<meta itemprop="position" content="2" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/25/note/tutorial_linux/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/dxm.jpg">
    <meta itemprop="name" content="dxm">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="blog_dxm">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h1><blockquote>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9saW51eC9saW51eC12aW0uaHRtbA==">vim菜鸟教程</span></li>
</ul>
</blockquote>
<h2 id="键位图"><a href="#键位图" class="headerlink" title="键位图"></a>键位图</h2><p><img data-src="/2024/04/25/note/tutorial_linux/001.png" alt="vim_keyboard"></p>
<h2 id="vim常用功能"><a href="#vim常用功能" class="headerlink" title="vim常用功能"></a>vim常用功能</h2><blockquote>
<ul>
<li>vim操作逻辑：<ul>
<li>{operator} + {motion} &#x3D; action ：一次编辑动作</li>
<li>{count} + {action}：重复count次action操作</li>
</ul>
</li>
<li>Command模式：<ul>
<li><code>:w</code>：保存文件；</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>:q</code>：退出 Vim 编辑器；</li>
<li><code>:wq</code>：保存文件并退出 Vim 编辑器；</li>
<li><code>:q!</code>：强制退出Vim编辑器，不保存修改；</li>
</ul>
</blockquote>
<h3 id="光标移动、复制粘贴、搜索替换"><a href="#光标移动、复制粘贴、搜索替换" class="headerlink" title="光标移动、复制粘贴、搜索替换"></a>光标移动、复制粘贴、搜索替换</h3><h4 id="光标移动"><a href="#光标移动" class="headerlink" title="光标移动"></a>光标移动</h4><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Styled Table</title>
<link rel="stylesheet" href="styles.css">
<style>
    .custom-table {
        width: 100%;
        border-collapse: collapse;
    }
    .custom-table th, .custom-table td {
        padding: 8px;
        text-align: center;
        border-bottom: 1px solid #ddd;
    }
    .custom-table tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    .custom-table tr:hover {
        background-color: #f5f5f5;
    }
    .custom-table thead {
        position: sticky;
        top: 0;
        background-color: #808080;
        color: white;
    }
    .custom-table thead tr:hover {
        background-color: #a9a9a9;
        color: black;
    }
    .custom-table, .custom-table th, .custom-table td {
        border: 1px solid black;
    }
</style>
</head>
<body>
<!-- 你的HTML内容将在这里，比如具体的表格数据 -->
</body>
</html>

<table class="custom-table">
    <thead>
        <tr>
            <th>快捷键</th>
            <th>功能</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>h、j、k、l</td>
            <td>光标向左、下、上、右移动一个字符</td>
        </tr>
        <tr>
            <td>n {motion}/n space/n enter</td>
            <td>motion执行n次/向右移动n字符/向下移动n行</td>
        </tr>
        <tr>
            <td>0</td>
            <td>行首</td>
        </tr>
        <tr>
            <td>$</td>
            <td>行尾</td>
        </tr>
        <tr>
            <td>^</td>
            <td>第一个非空字符</td>
        </tr>
        <tr>
            <td>G</td>
            <td>文档最后一行</td>
        </tr>
        <tr>
            <td>ngg/nG</td>
            <td>移动到文档第n行（默认n = 1）</td>
        </tr>
        <tr>
            <td>+/-</td>
            <td>非空格符的下/上一行</td>
        </tr>
        <tr>
            <td>m{mark}/`{mark}</td>
            <td>当前位置标记为mark/跳转到mark位置</td>
        </tr>
        <tr>
            <td>zt/zz/zb</td>
            <td>将当前行移至窗口顶部/中央/底部</td>
        </tr>
        <tr>
            <td>H/M/L</td>
            <td>光标移动到屏幕第一行/中间行/最后一行</td>
        </tr>
        <tr>
            <td>ctrl + f/ctrl + b</td>
            <td>屏幕向下/上移动一页</td>
        </tr>
        <tr>
            <td>ctrl + d/ctrl + u</td>
            <td>屏幕向下/上移动半页</td>
        </tr>
        <tr>
            <td>v/ctrl + v</td>
            <td>视觉模式/列视觉模式</td>
        </tr>
        <tr>
            <td>v + < / v + ></td>
            <td>首行缩进/取消缩进</td>
        </tr>
    </tbody>
</table>

<h4 id="搜索替换"><a href="#搜索替换" class="headerlink" title="搜索替换"></a>搜索替换</h4><table class="custom-table">
    <thead>
        <tr>
            <th>快捷键</th>
            <th>功能</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>/pattern ?pattern</td>
            <td>在文本中向下/上搜索pattern字符</td>
        </tr>
        <tr>
            <td>*</td>
            <td>等价于/pattern</td>
        </tr>
        <tr>
            <td>n/N</td>
            <td>重复前一个搜索操作/反向重复前一个搜索操作</td>
        </tr>
        <tr>
            <td>:n1,n2s/word1/word2/gc</td>
            <td>在n1~n2行之间将word1替换成word2</td>
        </tr>
        <tr>
            <td>:n1,n2s/\<word1\>/word2/gc</word1\></td>
            <td>精准匹配字符串word1</td>
        </tr>
        <tr>
            <td>:1,$s/word1/word2/g 或 :%s/word1/word2/g</td>
            <td>替换范围为第一行～最后一行</td>
        </tr>
        <tr>
            <td>* + :%s//pattern2/gc</td>
            <td>使用*快速选中pattern1进行替换</td>
        </tr>
        <tr>
            <td>v + s/^/\/\//（\cc）</td>
            <td>添加行前注释</td>
        </tr>
        <tr>
            <td>v + s/^\/\///（\cu）</td>
            <td>取消行前注释</td>
        </tr>
    </tbody>
</table>

<h4 id="删除复制粘贴"><a href="#删除复制粘贴" class="headerlink" title="删除复制粘贴"></a>删除复制粘贴</h4><table class="custom-table">
    <thead>
        <tr>
            <th>快捷键</th>
            <th>功能</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>nx/nX</td>
            <td>向后/前删除n个字符（默认n = 1）</td>
        </tr>
        <tr>
            <td>dd/ndd</td>
            <td>删除当前行/删除光标所在行开始的n行</td>
        </tr>
        <tr>
            <td>dG/d1G</td>
            <td>删除光标所在行到最后一行/第一行</td>
        </tr>
        <tr>
            <td>d$/d0/d^</td>
            <td>删除光标所在位置到该行末尾/行首/第一个非空字符</td>
        </tr>
        <tr>
            <td>di{/da{/di(/da(</td>
            <td>删除{}/()内部/包含{}/()在内的所有内容</td>
        </tr>
        <tr>
            <td>diw/daw</td>
            <td>删除光标所在单词/删除光标所在单词及后面的空格（单词后无空格则删除单词前空格）</td>
        </tr>
        <tr>
            <td>yy/nyy</td>
            <td>复制当前行/复制光标所在行开始的n行</td>
        </tr>
        <tr>
            <td>yG/y1G</td>
            <td>复制光标所在行到最后一行/第一行</td>
        </tr>
        <tr>
            <td>y$/y0/y^</td>
            <td>复制光标所在位置到该行末尾/行首/第一个非空字符</td>
        </tr>
        <tr>
            <td>yi{/ya{/yi(/ya(</td>
            <td>复制{}/()内部/包含{}/()在内的所有内容</td>
        </tr>
        <tr>
            <td>yiw/yaw</td>
            <td>复制光标所在单词/复制光标所在单词及后面的空格（单词后无空格则复制单词前空格）</td>
        </tr>
        <tr>
            <td>p/P</td>
            <td>在光标后/前粘贴（复制整行时在下一行/上一行粘贴）</td>
        </tr>
        <tr>
            <td>cw/ciw/caw/c$/c0/c^</td>
            <td>更改光标位置到单词末尾/整个单词/包含空格的整个单词/行尾/行首/第一个非空字符</td>
        </tr>
        <tr>
            <td>J</td>
            <td>将当前行和下一行合并为1行</td>
        </tr>
        <tr>
            <td>.</td>
            <td>重复前一个动作</td>
        </tr>
        <tr>
            <td>u</td>
            <td>撤销最近的修改</td>
        </tr>
        <tr>
            <td>ctrl + r</td>
            <td>nromal模式：u撤销更改后，ctrl + r重做这些更改<br>insert模式：ctrl + r + "/%/number，插入寄存器内容（当前缓冲区/文件名称/寄存器number）</td>
        </tr>
    </tbody>
</table>

<h3 id="编辑模式"><a href="#编辑模式" class="headerlink" title="编辑模式"></a>编辑模式</h3><table class="custom-table">
    <thead>
        <tr>
            <th>快捷键</th>
            <th>功能</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>i, I</td>
            <td>当前光标位置输入/当前行第一个非空字符位置输入</td>
        </tr>
        <tr>
            <td>a, A</td>
            <td>当前光标下一个字符位置输入/当前行最后一个字符位置输入</td>
        </tr>
        <tr>
            <td>o, O</td>
            <td>当前行下一行/上一行插入一个新行</td>
        </tr>
        <tr>
            <td>r, R</td>
            <td>替换光标位置字符/一直替换光标所在位置字符</td>
        </tr>
        <tr>
            <td>[Esc]</td>
            <td>退出Insert模式，回到Normal模式</td>
        </tr>
    </tbody>
</table>





<h2 id="plug-in"><a href="#plug-in" class="headerlink" title="plug-in"></a>plug-in</h2><ul>
<li><code>vim ~/.vimrc</code>：添加需要更改的设置，每次启动vim自动更新配置</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> number               <span class="string">&quot; 开启行号显示, set nonumber</span></span><br><span class="line"><span class="string">set hlsearch             &quot;</span> 搜索时高亮显示匹配项</span><br><span class="line"><span class="built_in">set</span> cursorline           <span class="string">&quot; 高亮显示当前行，set nocursorline</span></span><br><span class="line"><span class="string">&quot;</span> <span class="built_in">set</span> relativenumber: 开启相对行数；<span class="built_in">set</span> norelativenumber: 关闭相对行数</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> tabstop=4            <span class="string">&quot; 设置一个 Tab 为 4 个字符宽</span></span><br><span class="line"><span class="string">set shiftwidth=4         &quot;</span> 设置缩进 4 个字符宽</span><br><span class="line"><span class="built_in">set</span> expandtab            <span class="string">&quot; 使用空格代替 Tab</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">call plug#begin(&#x27;~/.vim/plugged&#x27;)   &quot;</span> 开始插件配置</span><br><span class="line">Plug <span class="string">&#x27;scrooloose/nerdcommenter&#x27;</span>    <span class="string">&quot; 添加插件：方便的注释功能</span></span><br><span class="line"><span class="string">Plug &#x27;mg979/vim-visual-multi&#x27;, &#123;&#x27;branch&#x27;: &#x27;master&#x27;&#125;  &quot;</span> 添加插件：多光标编辑支持</span><br><span class="line">call plug<span class="comment">#end()                    &quot; 结束插件配置</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot; 设置标签页的正常显示样式</span></span><br><span class="line"><span class="string">highlight TabLineFill ctermfg=LightGrey ctermbg=DarkGrey  &quot;</span> 设置未激活标签的填充颜色</span><br><span class="line">highlight TabLine ctermfg=White ctermbg=Black             <span class="string">&quot; 设置未激活标签的颜色</span></span><br><span class="line"><span class="string">highlight TabLineSel ctermfg=Black ctermbg=LightGrey      &quot;</span> 设置激活标签的颜色</span><br><span class="line"></span><br><span class="line"><span class="string">&quot; 使当前激活的标签页更加明显</span></span><br><span class="line"><span class="string">set tabline=%!MyTabLine()     &quot;</span> 设置自定义标签页行显示</span><br><span class="line"><span class="keyword">function</span> MyTabLine()          <span class="string">&quot; 定义一个函数来自定义标签行</span></span><br><span class="line"><span class="string">  let s = &#x27;&#x27;</span></span><br><span class="line"><span class="string">  for i in range(tabpagenr(&#x27;$&#x27;))   &quot;</span> 遍历所有标签页</span><br><span class="line">    <span class="string">&quot; 添加分界符和页面序号</span></span><br><span class="line"><span class="string">    let s .= &#x27;%&#x27; . (i + 1) . &#x27;T&#x27;</span></span><br><span class="line"><span class="string">    &quot;</span> 当前页使用特殊颜色</span><br><span class="line">    <span class="built_in">let</span> s .= (i + 1 == tabpagenr() ? <span class="string">&#x27;%#TabLineSel#&#x27;</span> : <span class="string">&#x27;%#TabLine#&#x27;</span>)</span><br><span class="line">    <span class="string">&quot; 设置标签名或显示文件名</span></span><br><span class="line"><span class="string">    let s .= &#x27; &#x27; . (i + 1) . &#x27;. &#x27; . GetTabLabel(i + 1) . &#x27; &#x27;</span></span><br><span class="line"><span class="string">  endfor</span></span><br><span class="line"><span class="string">  &quot;</span> 添加最后的填充</span><br><span class="line">  <span class="built_in">let</span> s .= <span class="string">&#x27;%#TabLineFill#%T&#x27;</span></span><br><span class="line">  <span class="built_in">return</span> s </span><br><span class="line">endfunction</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> GetTabLabel(n)      <span class="string">&quot; 定义一个函数获取标签的标签名</span></span><br><span class="line"><span class="string">  &quot;</span> 返回第n个标签的标签名称或文件名</span><br><span class="line">  <span class="built_in">let</span> buflist = tabpagebuflist(a:n)  <span class="string">&quot; 获取指定标签页的缓冲区列表</span></span><br><span class="line"><span class="string">  let winnr = tabpagewinnr(a:n)      &quot;</span> 获取激活的窗口编号</span><br><span class="line">  <span class="built_in">return</span> bufname(buflist[winnr - 1]) <span class="string">&quot; 返回当前窗口缓冲区的文件名</span></span><br><span class="line"><span class="string">endfunction</span></span><br></pre></td></tr></table></figure>

<h3 id="注释插件"><a href="#注释插件" class="headerlink" title="注释插件"></a>注释插件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 vim-plug 插件（插件管理器）</span></span><br><span class="line">curl -fLo ~/.vim/autoload/plug.vim --create-dirs \</span><br><span class="line">https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在～/.vimrc文件中添加以下内容</span></span><br><span class="line">vim ~/.vimrc</span><br><span class="line">call plug<span class="comment">#begin(&#x27;~/.vim/plugged&#x27;)</span></span><br><span class="line">Plug <span class="string">&#x27;scrooloose/nerdcommenter&#x27;</span></span><br><span class="line">call plug<span class="comment">#end()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新打开vim，运行以下命令从 GitHub 下载并安装 nerdcommenter 插件</span></span><br><span class="line">:PlugInstall</span><br></pre></td></tr></table></figure>










<h1 id="文本处理工具"><a href="#文本处理工具" class="headerlink" title="文本处理工具"></a>文本处理工具</h1><h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><blockquote>
<p>grep [options] pattern [files]</p>
</blockquote>
<ul>
<li><code>options</code>：<ul>
<li><code>-i</code>：忽略大小写差异。（ignore）</li>
<li><code>-v</code>：反向匹配，仅显示不包含匹配文本的行。（invert match）</li>
<li><code>-n</code>：显示匹配行及其行号。（line number）</li>
<li><code>-r</code>或<code>-R</code>：递归查找，搜索指定目录下的所有文件和子目录。（recursive）</li>
<li><code>-l</code>：仅列出包含匹配行的文件名，而不显示匹配的文本。（list file with matches）</li>
<li><code>-c</code>：仅显示每个文件中匹配到的行数。（count）</li>
</ul>
</li>
<li><code>pattern</code>：这是你要搜索的文本或正则表达式。</li>
<li><code>files</code>：这是一个或多个要搜索的文件。如果省略此参数，grep将从标准输入读取数据。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="string">&quot;\[npu::inst_cluster3::tile\[0\]::sv\]&quot;</span> debug.log &gt; c3t0.log</span><br><span class="line">grep -e <span class="string">&quot;SV_U2U_W&quot;</span> -e <span class="string">&quot;SV_U2U_R&quot;</span> debug.log &gt; 1.txt        <span class="comment"># 搜索带有U2U_W和U2U_R的行</span></span><br><span class="line">grep -o <span class="string">&quot;cluster8::tile\[0\].*&quot;</span> debug.log &gt; 2.txt         <span class="comment"># 搜索匹配cluster8::tile0及后续内容的行</span></span><br><span class="line">grep -o <span class="string">&quot;cluster8::tile\[0\].*SV_U2U_W.*&quot;</span> debug.log &gt; 3.txt</span><br><span class="line">grep <span class="string">&quot;关键字1&quot;</span> 文件名 ｜ grep <span class="string">&quot;关键字2&quot;</span> &gt; 3.txt</span><br><span class="line">grep -o <span class="string">&quot;\[Tile 32.* Update.*&quot;</span> 1.data &gt; 4.txt</span><br><span class="line">grep -e <span class="string">&quot;slice.*axi_w1&quot;</span> -e <span class="string">&quot;slice.*u2u_r&quot;</span> 5.txt | sed <span class="string">&#x27;s/axi_w1/u2u_w/g&#x27;</span> &gt; sv.log</span><br><span class="line"></span><br><span class="line">grep --text <span class="string">&quot;count&quot;</span> | <span class="built_in">wc</span> -l</span><br></pre></td></tr></table></figure>



<h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><blockquote>
<p>awk [options] ‘program’ [files]</p>
</blockquote>
<ul>
<li><code>program</code>：通常由pattern + action组成：<ul>
<li>模式匹配（pattern）：选择哪些行需要应用action（默认应用所有行）；</li>
<li>操作{ action }：包括但不限于<strong>打印</strong>、<strong>修改</strong>、<strong>处理</strong>数据（默认为 print）；</li>
</ul>
</li>
<li><code>files</code>：指定输入文件的名称（省略&#x2F;- 读取标准输入）；</li>
<li>常用命令结构：<ul>
<li>pattern { action }：当输入行匹配pattern时，执行action；</li>
<li>BEGIN { action }：在处理任何输入行之前执行的action。</li>
<li>END { action }：在处理完所有输入行之后执行的action。</li>
</ul>
</li>
<li>常用选项：<ul>
<li>-F fs：设置输入字段的分隔符为fs。</li>
<li>-v var&#x3D;value：在程序开始之前，设置一个awk变量var的值为value。</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印文件每一行</span></span><br><span class="line">awk <span class="string">&#x27;&#123;print&#125;&#x27;</span> filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印所有包含“error”的行，/error/是pattern用于筛选文本</span></span><br><span class="line">awk <span class="string">&#x27;/error/ &#123;print $0&#125;&#x27;</span> filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模式匹配 + 正则表达式进一步细化筛选条件</span></span><br><span class="line">awk <span class="string">&#x27;/error/ &amp;&amp; $1 &gt; 100 &#123;print $0&#125;&#x27;</span> filename</span><br><span class="line"><span class="comment"># 对特定字段进行pattern匹配</span></span><br><span class="line">awk <span class="string">&#x27;$2 ~ /pattern/ &#123;print $0&#125;&#x27;</span> filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># 条件打印，如果第2个变量字符长度大于4则打印第1、3个变量</span></span><br><span class="line">awk <span class="string">&#x27;$2 &gt; 4 &#123;print $1, $3&#125;&#x27;</span> filename</span><br><span class="line">awk <span class="string">&#x27;length($2) &gt; 4 &#123;print $1, $3&#125;&#x27;</span> filename</span><br><span class="line">awk <span class="string">&#x27;/length($2) &gt; 4/ &#123;print $1, $3&#125;&#x27;</span> filename</span><br></pre></td></tr></table></figure>

<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><h4 id="accuracy-mismatch"><a href="#accuracy-mismatch" class="headerlink" title="accuracy_mismatch"></a>accuracy_mismatch</h4><ul>
<li>awk命令</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    if (match($0, /\(c, y, x\) = \([^)]+\)/)) &#123;</span></span><br><span class="line"><span class="string">        cxy = substr($0, RSTART, RLENGTH);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if (match($0, /\(round_yi, round_xi\) = \([^)]+\)/)) &#123;</span></span><br><span class="line"><span class="string">        ryx = substr($0, RSTART, RLENGTH);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if (cxy &amp;&amp; ryx)</span></span><br><span class="line"><span class="string">        print cxy, ryx;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> 1.<span class="built_in">log</span> &gt; 2.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>

<ul>
<li>src.log</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Testing frame80...</span><br><span class="line">Saved NCHW layout to rotate<span class="built_in">_</span>nearest<span class="built_in">_</span>pytorch<span class="built_in">_</span>frame80<span class="built_in">_</span>input<span class="built_in">_</span>nchw.bin, shape: torch.Size([32, 8, 400, 200])</span><br><span class="line">Saved NHWC layout to rotate<span class="built_in">_</span>nearest<span class="built_in">_</span>pytorch<span class="built_in">_</span>frame80<span class="built_in">_</span>input<span class="built_in">_</span>nhwc.bin, shape: torch.Size([32, 400, 200, 8])</span><br><span class="line">Saved NCHW layout to rotate<span class="built_in">_</span>nearest<span class="built_in">_</span>pytorch<span class="built_in">_</span>frame80<span class="built_in">_</span>output<span class="built_in">_</span>nchw.bin, shape: torch.Size([32, 8, 400, 200])</span><br><span class="line">Saved NHWC layout to rotate<span class="built_in">_</span>nearest<span class="built_in">_</span>pytorch<span class="built_in">_</span>frame80<span class="built_in">_</span>output<span class="built_in">_</span>nhwc.bin, shape: torch.Size([32, 400, 200, 8])</span><br><span class="line">[frame80] angle (fp64): 11.595370230811710</span><br><span class="line">[frame80] angle (fp32): 11.595370230811710</span><br><span class="line">(c, y, x) = (0, 0, 77)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (-0.4509754180908203, 117.55844116210938)  (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 118) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (0, 118)</span><br><span class="line">(c, y, x) = (0, 0, 78)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (-0.24997615814208984, 118.53804016113281) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 119) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (0, 119)</span><br><span class="line">(c, y, x) = (0, 0, 79)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (-0.04897785186767578, 119.51762390136719) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 120) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (0, 120)</span><br><span class="line">(c, y, x) = (0, 0, 80)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (0.15202045440673828, 120.49722290039062)  (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 120) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (0, 120)</span><br><span class="line">(c, y, x) = (0, 0, 81)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (0.35302066802978516, 121.476806640625)    (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 121) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (0, 121)</span><br><span class="line">(c, y, x) = (0, 0, 82)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (0.5540189743041992, 122.45640563964844)   (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (1, 122) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (1, 122)</span><br><span class="line">(c, y, x) = (0, 0, 83)  (y<span class="built_in">_</span>i, x<span class="built_in">_</span>i) = (0.7550172805786133, 123.43598937988281)   (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (1, 123) (int<span class="built_in">_</span>yi, int<span class="built_in">_</span>xi) = (1, 123)</span><br></pre></td></tr></table></figure>

<ul>
<li>dst.log</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(c, y, x) = (0, 0, 77) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 118)</span><br><span class="line">(c, y, x) = (0, 0, 78) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 119)</span><br><span class="line">(c, y, x) = (0, 0, 79) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 120)</span><br><span class="line">(c, y, x) = (0, 0, 80) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 120)</span><br><span class="line">(c, y, x) = (0, 0, 81) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (0, 121)</span><br><span class="line">(c, y, x) = (0, 0, 82) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (1, 122)</span><br><span class="line">(c, y, x) = (0, 0, 83) (round<span class="built_in">_</span>yi, round<span class="built_in">_</span>xi) = (1, 123)</span><br></pre></td></tr></table></figure>

<h4 id="sv-log"><a href="#sv-log" class="headerlink" title="sv_log"></a>sv_log</h4><ul>
<li>awk命令</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;/Tile 0/ &amp;&amp; /Update/ &#123;</span></span><br><span class="line"><span class="string">    idx = index($0, &quot;[Tile&quot;);</span></span><br><span class="line"><span class="string">    if (idx &gt; 0) &#123;</span></span><br><span class="line"><span class="string">        print substr($0, idx);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> 1.txt &gt; 3.<span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用grep实现</span></span><br><span class="line">grep -e <span class="string">&quot;Tile 0&quot;</span> 1.txt | grep <span class="string">&quot;Update&quot;</span> | grep -o <span class="string">&quot;\[Tile.*&quot;</span> &gt; 4.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>

<ul>
<li>src.log</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">#</span> New execution started</span><br><span class="line">2024-03-20 17:19:06.198119828 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init</span><br><span class="line">2024-03-20 17:19:06.198125820 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init ccpu program 0 hcpu program 0</span><br><span class="line">2024-03-20 17:19:06.198126357 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init ccpu option 0</span><br><span class="line">2024-03-20 17:19:06.198126755 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init hcpu option 0</span><br><span class="line">2024-03-20 17:19:06.198127737 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init ccpu body </span><br><span class="line">2024-03-20 17:19:06.217334580 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init hcpu body </span><br><span class="line">2024-03-20 17:19:06.221835469 :0 NOTICE[0]: spike<span class="built_in">_</span>fm<span class="built_in">_</span>top: init finished</span><br><span class="line">2024-03-20 17:19:06.256568272 :0 NOTICE[1]: [HIBDMA 0 channel 0]: Started one instruction.</span><br><span class="line">2024-03-20 17:19:06.258692580 :0 NOTICE[1]: [HIBDMA 0 channel 0]: Finished one instruction.</span><br><span class="line">2024-03-20 17:19:06.316320218 :0 NOTICE[2]: [Tile 0 SVCTRL]: Started one instruction. Instr tag: 0x0</span><br><span class="line">2024-03-20 17:19:06.317258092 :0 NOTICE[2]: [Tile 0 SVCTRL]: Finished one instruction. Instr tag: 0x0</span><br><span class="line">2024-03-20 17:19:06.317264341 :0 NOTICE[2]: [Tile 0]: Update SV<span class="built_in">_</span>TILE<span class="built_in">_</span>CTRL = 0</span><br><span class="line">2024-03-20 17:19:06.317266446 :0 NOTICE[2]: [Tile 0]: Update SV<span class="built_in">_</span>DRB<span class="built_in">_</span>W = 00</span><br><span class="line">2024-03-20 17:19:06.317268676 :0 NOTICE[2]: [Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>R0 = 0</span><br><span class="line">2024-03-20 17:19:06.317270666 :0 NOTICE[2]: [Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>W0 = 0</span><br><span class="line">2024-03-20 17:19:06.317272391 :0 NOTICE[2]: [Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>R1 = 0</span><br><span class="line">2024-03-20 17:19:06.317273934 :0 NOTICE[2]: [Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>W1 = 0</span><br><span class="line">2024-03-20 17:19:06.317255146 :0 NOTICE[5]: [Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>R0 = 0</span><br><span class="line">2024-03-20 17:19:06.318227982 :0 NOTICE[5]: [Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>W0 = 0</span><br><span class="line">2024-03-20 17:19:06.318230260 :0 NOTICE[5]: [Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>R1 = 0</span><br><span class="line">2024-03-20 17:19:06.318231995 :0 NOTICE[5]: [Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>W1 = 0</span><br><span class="line">2024-03-20 17:19:06.317267074 :0 NOTICE[6]: [Tile 0]: Update SV<span class="built_in">_</span>U2U<span class="built_in">_</span>R = 0</span><br><span class="line">2024-03-20 17:19:06.318271057 :0 NOTICE[6]: [Tile 0]: Update SV<span class="built_in">_</span>U2U<span class="built_in">_</span>W = 0</span><br><span class="line">2024-03-20 17:19:06.317256828 :0 NOTICE[3]: [Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>NLU<span class="built_in">_</span>W = 0</span><br><span class="line">2024-03-20 17:19:06.318557186 :0 NOTICE[3]: [Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>ACT<span class="built_in">_</span>R = 0</span><br><span class="line">2024-03-20 17:19:06.318560228 :0 NOTICE[3]: [Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>WGT<span class="built_in">_</span>R = 0</span><br><span class="line">2024-03-20 17:19:06.318562885 :0 NOTICE[3]: [Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>WSE<span class="built_in">_</span>R = 0</span><br><span class="line">2024-03-20 17:19:06.318927308 :0 NOTICE[0]: Barrier mask 0000000000000000000000000000000000000000000000000000000000000001: Starting one instruction. Instr tag: 0x0</span><br><span class="line">2024-03-20 17:19:06.317258352 :0 NOTICE[4]: [Tile 0]: Update SV<span class="built_in">_</span>CVU<span class="built_in">_</span>R0 = 0</span><br><span class="line">2024-03-20 17:19:06.319172200 :0 NOTICE[4]: [Tile 0]: Update SV<span class="built_in">_</span>CVU<span class="built_in">_</span>R1 = 0</span><br><span class="line">2024-03-20 17:19:06.319176623 :0 NOTICE[4]: [Tile 0]: Update SV<span class="built_in">_</span>CVU<span class="built_in">_</span>W = 0</span><br><span class="line">2024-03-20 17:19:06.319634699 :0 NOTICE[2]: [Tile 0Barrier: fenck ack.</span><br><span class="line">2024-03-20 17:19:06.319661379 :0 NOTICE[1]: Barrier mask 0000000000000000000000000000000000000000000000000000000000000001: Receive from tile 0</span><br><span class="line">2024-03-20 17:19:06.319687388 :0 NOTICE[1]: [T=16]Barrier mask 0000000000000000000000000000000000000000000000000000000000000001 passed: Finished one instruction. Instr tag: 0x0</span><br><span class="line">2024-03-20 17:19:06.323494662 :0 NOTICE[7]: [HIBDMA 0 channel 0]: Started one instruction.</span><br><span class="line">2024-03-20 17:19:06.325598258 :0 NOTICE[7]: [HIBDMA 0 channel 0]: Update Tile 0 SV<span class="built_in">_</span>DRB<span class="built_in">_</span>W++</span><br><span class="line">2024-03-20 17:19:06.325705359 :0 NOTICE[1]: [Tile 0]: Update SV<span class="built_in">_</span>DRB<span class="built_in">_</span>W = 1</span><br></pre></td></tr></table></figure>

<ul>
<li>dst.log</li>
</ul>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>TILE<span class="built_in">_</span>CTRL = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>DRB<span class="built_in">_</span>W = 00</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>R0 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>W0 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>R1 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>AXI<span class="built_in">_</span>W1 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>R0 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>W0 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>R1 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CE<span class="built_in">_</span>W1 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>U2U<span class="built_in">_</span>R = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>U2U<span class="built_in">_</span>W = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>NLU<span class="built_in">_</span>W = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>ACT<span class="built_in">_</span>R = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>WGT<span class="built_in">_</span>R = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>TCC<span class="built_in">_</span>WSE<span class="built_in">_</span>R = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CVU<span class="built_in">_</span>R0 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CVU<span class="built_in">_</span>R1 = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>CVU<span class="built_in">_</span>W = 0</span><br><span class="line">[Tile 0]: Update SV<span class="built_in">_</span>DRB<span class="built_in">_</span>W = 1</span><br></pre></td></tr></table></figure>



<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><h2 id="others"><a href="#others" class="headerlink" title="others"></a>others</h2><h1 id="shell-script"><a href="#shell-script" class="headerlink" title="shell script"></a>shell script</h1><h2 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;&#125;</span>：</span><br><span class="line"><span class="variable">$&#123;&#125;</span> 主要用于变量替换和参数替换。</span><br><span class="line"><span class="variable">$&#123;var&#125;</span> 表示取变量 var 的值。</span><br><span class="line"><span class="variable">$&#123;var:-default&#125;</span> 表示如果变量 var 未定义或者为空，则使用默认值 default。</span><br><span class="line"><span class="variable">$&#123;var:=default&#125;</span> 表示如果变量 var 未定义或者为空，则将其设置为默认值 default。</span><br><span class="line"><span class="variable">$&#123;#var&#125;</span> 表示返回变量 var 的长度。</span><br><span class="line"><span class="variable">$&#123;var:start:length&#125;</span> 表示从变量 var 的第 start 个字符开始，截取 length 个字符。</span><br><span class="line">等等。</span><br><span class="line">$()：</span><br><span class="line">$() 是命令替换的语法，用于将命令的输出结果赋值给变量或者直接输出。</span><br><span class="line">$() 中放置的命令会被执行，并且 $() 会将命令的标准输出作为结果返回。</span><br><span class="line">例如，var=$(<span class="built_in">command</span>) 表示执行 <span class="built_in">command</span> 命令，并将其输出赋值给变量 var。</span><br></pre></td></tr></table></figure>


<h3 id="dxm-cf-sh"><a href="#dxm-cf-sh" class="headerlink" title="dxm_cf.sh"></a>dxm_cf.sh</h3><blockquote>
<p><code>./dxm_cf.sh -c MH20_Resize_Conv_16tiles_2slice_int8 -s pm</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -euo pipefail</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">usage</span></span>() &#123;</span><br><span class="line">    <span class="built_in">cat</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">    Usage: $0 [options]</span></span><br><span class="line"><span class="string">    Options:</span></span><br><span class="line"><span class="string">    -h|--help               This Message.</span></span><br><span class="line"><span class="string">    -c|--case_name          Case name</span></span><br><span class="line"><span class="string">    -s|--stage              Stage name (pm, runtime, fm, python)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">options_parse</span></span>() &#123;</span><br><span class="line">    <span class="keyword">while</span> [ <span class="variable">$#</span> -gt 0 ]; <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">            -c|--case_name)</span><br><span class="line">              <span class="keyword">if</span> [[ ! -z <span class="variable">$2</span> ]] &amp;&amp; [[ <span class="variable">$2</span> != -* ]];<span class="keyword">then</span></span><br><span class="line">                case_name=<span class="variable">$2</span></span><br><span class="line">                <span class="built_in">shift</span></span><br><span class="line">              <span class="keyword">fi</span></span><br><span class="line">              ;;</span><br><span class="line">            -s|--stage)</span><br><span class="line">              <span class="keyword">if</span> [[ ! -z <span class="variable">$2</span> ]] &amp;&amp; [[ <span class="variable">$2</span> != -* ]];<span class="keyword">then</span></span><br><span class="line">                stage=<span class="variable">$2</span></span><br><span class="line">                <span class="built_in">shift</span></span><br><span class="line">              <span class="keyword">fi</span></span><br><span class="line">              ;;</span><br><span class="line">            -*|-h|--<span class="built_in">help</span>)</span><br><span class="line">                usage</span><br><span class="line">                <span class="built_in">exit</span> 0</span><br><span class="line">                ;;</span><br><span class="line">            *)</span><br><span class="line">                print_center <span class="string">&quot;Error: Invalid argument&quot;</span></span><br><span class="line">                usage</span><br><span class="line">                <span class="built_in">exit</span> 1</span><br><span class="line">                ;;</span><br><span class="line">        <span class="keyword">esac</span></span><br><span class="line">        <span class="built_in">shift</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">print_center</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> text=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">local</span> cols=$(tput cols)</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%*s\n&quot;</span> $(((<span class="variable">$&#123;#text&#125;</span>+<span class="variable">$cols</span>)/<span class="number">2</span>)) <span class="string">&quot;<span class="variable">$text</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">    usage</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">options_parse <span class="variable">$@</span></span><br><span class="line">print_center <span class="string">&quot;================ <span class="variable">$0</span> <span class="variable">$case_name</span> <span class="variable">$stage</span> ================&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># define common file path</span></span><br><span class="line">workspace_dir=$(<span class="built_in">pwd</span>)</span><br><span class="line">log_dir=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/log/<span class="variable">$&#123;case_name&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$&#123;log_dir&#125;</span></span><br><span class="line">pm_log=<span class="string">&quot;<span class="variable">$&#123;log_dir&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>_pm.log&quot;</span></span><br><span class="line">runtime_log=<span class="string">&quot;<span class="variable">$&#123;log_dir&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>_runtime.log&quot;</span></span><br><span class="line">fm_log=<span class="string">&quot;<span class="variable">$&#123;log_dir&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>_fm.log&quot;</span></span><br><span class="line">camera_fusion_instr_data=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/runtime/test/golden_test/schu_instr_executor/massive_hit/<span class="variable">$&#123;case_name&#125;</span>/&quot;</span></span><br><span class="line">camera_fusion_bin=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/runtime/builddir/massive_hit_<span class="variable">$&#123;case_name&#125;</span>/massive_hit_<span class="variable">$&#123;case_name&#125;</span>.bin&quot;</span></span><br><span class="line">golden_output_bin=<span class="string">&quot;<span class="variable">$&#123;camera_fusion_instr_data&#125;</span>golden_output.bin&quot;</span></span><br><span class="line">microbench_out_bin=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/data/microbench_camera_fusion_out.bin&quot;</span></span><br><span class="line">meson_build_file=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/dataflow_net/meson.build&quot;</span></span><br><span class="line">testcase_resize=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/dataflow_net/op_net/ops/test_ops/resize/testcase_resize.cpp&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">pm_compile</span></span>() &#123;</span><br><span class="line">    <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/dataflow_net/builddir&quot;</span></span><br><span class="line">    <span class="built_in">local</span> slice_num=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;case_name&#125;</span>&quot;</span> | grep -oP <span class="string">&#x27;\d+slice&#x27;</span> | grep -oP <span class="string">&#x27;\d+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$slice_num</span>&quot;</span> == <span class="string">&quot;1&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        sed -i <span class="string">&#x27;s/^\(#define MULTI_SLICE_ENABLE\)/\/\/\1/&#x27;</span> <span class="string">&quot;<span class="variable">$testcase_resize</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sed -i <span class="string">&#x27;s/^\/\/\(.*#define MULTI_SLICE_ENABLE.*\)/\1/&#x27;</span> <span class="string">&quot;<span class="variable">$testcase_resize</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    sed -i -e <span class="string">&quot;s/#define SLICE_NUM .*/#define SLICE_NUM <span class="variable">$&#123;slice_num&#125;</span>/&quot;</span> \</span><br><span class="line">           -e <span class="string">&quot;s/#define CASE_NAME .*/#define CASE_NAME \&quot;<span class="variable">$&#123;case_name&#125;</span>\&quot;/&quot;</span> <span class="string">&quot;<span class="variable">$testcase_resize</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> grep -q <span class="string">&quot;executable (&#x27;resize&#x27;&quot;</span> <span class="string">&quot;<span class="variable">$meson_build_file</span>&quot;</span>; <span class="keyword">then</span></span><br><span class="line">        print_center <span class="string">&quot;resize ====&gt; <span class="variable">$&#123;case_name&#125;</span>&quot;</span></span><br><span class="line">        sed -i <span class="string">&quot;s/executable (&#x27;resize&#x27;/executable (&#x27;<span class="variable">$&#123;case_name&#125;</span>&#x27;/g&quot;</span> <span class="string">&quot;<span class="variable">$meson_build_file</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        original_pattern=$(awk <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">            if (match($0, /MH20_Resize_Conv_16tiles_[0-9]+slice_int8/)) &#123;</span></span><br><span class="line"><span class="string">                print substr($0, RSTART, RLENGTH)</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;&#x27;</span> <span class="string">&quot;<span class="variable">$meson_build_file</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> [[ -n <span class="string">&quot;<span class="variable">$original_pattern</span>&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">            print_center <span class="string">&quot;<span class="variable">$&#123;original_pattern&#125;</span> ====&gt; <span class="variable">$&#123;case_name&#125;</span>&quot;</span></span><br><span class="line">            sed -i <span class="string">&quot;s/<span class="variable">$original_pattern</span>/<span class="variable">$&#123;case_name&#125;</span>/g&quot;</span> <span class="string">&quot;<span class="variable">$meson_build_file</span>&quot;</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$case_name</span> pm compile start ================&quot;</span></span><br><span class="line">    ninja <span class="variable">$&#123;case_name&#125;</span> &amp;&gt; <span class="variable">$&#123;pm_log&#125;</span> || &#123; print_center <span class="string">&quot;Compilation failed, exiting...&quot;</span>; <span class="built_in">exit</span> 1; &#125;</span><br><span class="line">    ./<span class="variable">$&#123;case_name&#125;</span> &gt;&gt; <span class="variable">$&#123;pm_log&#125;</span> 2&gt;&amp;1</span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$case_name</span> pm compile end ================&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">runtime_compile</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [ ! -d \&quot;<span class="variable">$&#123;camera_fusion_instr_data&#125;</span>\&quot; ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">mkdir</span> -p <span class="variable">$&#123;camera_fusion_instr_data&#125;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">cp</span> -rf <span class="variable">$&#123;workspace_dir&#125;</span>/dataflow_net/builddir/net_dataflow/<span class="variable">$&#123;case_name&#125;</span>/* <span class="variable">$&#123;camera_fusion_instr_data&#125;</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$&#123;workspace_dir&#125;</span>/runtime</span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$&#123;case_name&#125;</span> runtime compile start ================&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;include($&#123;GOLDEN_ROOT&#125;/schu_instr_executor/CMakeLists.txt)&#x27;</span> &gt; <span class="variable">$&#123;workspace_dir&#125;</span>/runtime/test/golden_test/CMakeLists.txt</span><br><span class="line">    <span class="variable">$&#123;workspace_dir&#125;</span>/runtime/build.sh fm --cf-case=<span class="variable">$&#123;case_name&#125;</span> &amp;&gt; <span class="variable">$&#123;runtime_log&#125;</span></span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$&#123;case_name&#125;</span> runtime compile end ================&quot;</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$&#123;workspace_dir&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fm_execute</span></span>() &#123;</span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$&#123;case_name&#125;</span> fm execute start ================&quot;</span></span><br><span class="line">    <span class="variable">$&#123;workspace_dir&#125;</span>/ebb_model/fm/test/spike_fm_smoke/old_fm_d_smoke_test.bin <span class="variable">$&#123;camera_fusion_bin&#125;</span> &amp;&gt; <span class="variable">$&#123;fm_log&#125;</span></span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$&#123;case_name&#125;</span> fm execute end ================&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">python_check_result</span></span>() &#123;</span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$&#123;case_name&#125;</span> pyton check result start ================&quot;</span></span><br><span class="line">    python <span class="variable">$&#123;workspace_dir&#125;</span>/project_dxm/rotate/cosine_similarity.py <span class="variable">$&#123;golden_output_bin&#125;</span> <span class="variable">$&#123;microbench_out_bin&#125;</span></span><br><span class="line">    print_center <span class="string">&quot;================ <span class="variable">$&#123;case_name&#125;</span> python check result end ================&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -A stages=(</span><br><span class="line">    [<span class="string">&quot;pm&quot;</span>]=<span class="string">&quot;pm_compile&quot;</span></span><br><span class="line">    [<span class="string">&quot;runtime&quot;</span>]=<span class="string">&quot;runtime_compile&quot;</span></span><br><span class="line">    [<span class="string">&quot;fm&quot;</span>]=<span class="string">&quot;fm_execute&quot;</span></span><br><span class="line">    [<span class="string">&quot;python&quot;</span>]=<span class="string">&quot;python_check_result&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">execute=<span class="literal">false</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> <span class="string">&quot;pm&quot;</span> <span class="string">&quot;runtime&quot;</span> <span class="string">&quot;fm&quot;</span> <span class="string">&quot;python&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$stage</span> == <span class="variable">$key</span> || <span class="variable">$execute</span> == <span class="literal">true</span> || -z <span class="variable">$stage</span> ]]; <span class="keyword">then</span></span><br><span class="line">        execute=<span class="literal">true</span></span><br><span class="line">        <span class="built_in">eval</span> <span class="string">&quot;<span class="variable">$&#123;stages[$key]&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h3 id="dxm-vdk-sh"><a href="#dxm-vdk-sh" class="headerlink" title="dxm_vdk.sh"></a>dxm_vdk.sh</h3><blockquote>
<p><code>./dxm_vdk_rotate.sh -c rotate -s 1 -e 10</code></p>
</blockquote>
<h4 id="shell-script-1"><a href="#shell-script-1" class="headerlink" title="shell_script"></a>shell_script</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">usage</span></span>() &#123;</span><br><span class="line">    <span class="built_in">cat</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">    Usage: $0 [options]</span></span><br><span class="line"><span class="string">    Options:</span></span><br><span class="line"><span class="string">    -h|--help               Show this message.</span></span><br><span class="line"><span class="string">    -s|--start              Start frame number to process.</span></span><br><span class="line"><span class="string">    -e|--end                End frame number to process (if not provided, defaults to start frame).</span></span><br><span class="line"><span class="string">    -c|--case_name          Case name to process (default is $&#123;case_name&#125;).</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print_center</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> text=<span class="variable">$1</span></span><br><span class="line">    <span class="built_in">local</span> cols=$(tput cols)</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%*s\n&quot;</span> $(((<span class="variable">$&#123;#text&#125;</span>+<span class="variable">$cols</span>)/<span class="number">2</span>)) <span class="string">&quot;<span class="variable">$text</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">initialize</span></span>() &#123;</span><br><span class="line">    <span class="built_in">set</span> -euo pipefail</span><br><span class="line">    print_center <span class="string">&quot;Initializing script variables and paths...&quot;</span></span><br><span class="line">    workspace_dir=$(<span class="built_in">pwd</span>)</span><br><span class="line">    runtime_dir=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/runtime&quot;</span></span><br><span class="line">    fm_test_dir=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/ebb_model/fm/test/spike_fm_smoke&quot;</span></span><br><span class="line">    sample_data_dir=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/data&quot;</span></span><br><span class="line">    python_dir=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/project_dxm/rotate&quot;</span></span><br><span class="line">    frame_id=<span class="string">&quot;&quot;</span></span><br><span class="line">    frame_start=<span class="string">&quot;-1&quot;</span></span><br><span class="line">    frame_end=<span class="string">&quot;-1&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;Initialization complete.&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">config</span></span>() &#123;</span><br><span class="line">    print_center <span class="string">&quot;Configuring paths and names for frame <span class="variable">$&#123;frame_id&#125;</span>...&quot;</span></span><br><span class="line">    case_name=<span class="string">&quot;microbench_ipu_rotate_32tiles_fp8_nearest&quot;</span></span><br><span class="line">    input_original_name=<span class="string">&quot;input_200x400x8_fp8_32tile_nearest&quot;</span></span><br><span class="line">    output_original_name=<span class="string">&quot;output_200x400x8_fp8_32tile_nearest&quot;</span></span><br><span class="line">    input_target_name=<span class="string">&quot;rotate_nearest_pytorch_frame<span class="variable">$&#123;frame_id&#125;</span>_input_nhwc&quot;</span></span><br><span class="line">    output_target_name=<span class="string">&quot;rotate_nearest_pytorch_frame<span class="variable">$&#123;frame_id&#125;</span>_output_nhwc&quot;</span></span><br><span class="line"></span><br><span class="line">    golden_test=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/runtime/test/golden_test&quot;</span></span><br><span class="line">    target_cmakelists=<span class="string">&quot;<span class="variable">$&#123;golden_test&#125;</span>/CMakeLists.txt&quot;</span></span><br><span class="line">    golden_test_dir=<span class="string">&quot;<span class="variable">$&#123;golden_test&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>/data&quot;</span></span><br><span class="line">    cmake_file_path=<span class="string">&quot;<span class="variable">$&#123;golden_test&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>/CMakeLists.txt&quot;</span></span><br><span class="line">    rotate_h_path=<span class="string">&quot;<span class="variable">$&#123;golden_test&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>/include/rotate.h&quot;</span></span><br><span class="line">    angle_bin_path=<span class="string">&quot;<span class="variable">$&#123;workspace_dir&#125;</span>/project_dxm/golden_data/rotate/frame<span class="variable">$&#123;frame_id&#125;</span>/Input.angle.fp32.bin&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;Configuration for frame <span class="variable">$&#123;frame_id&#125;</span> done.&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">parse_options</span></span>() &#123;</span><br><span class="line">    print_center <span class="string">&quot;Parsing command line options...&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> [ <span class="variable">$#</span> -gt 0 ]; <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">            -s|--start)</span><br><span class="line">                <span class="keyword">if</span> [[ ! -z <span class="variable">$2</span> ]] &amp;&amp; [[ <span class="variable">$2</span> != -* ]];<span class="keyword">then</span></span><br><span class="line">                    frame_start=<span class="variable">$2</span></span><br><span class="line">                    <span class="built_in">shift</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    print_center <span class="string">&quot;Error: Missing start frame number&quot;</span></span><br><span class="line">                    <span class="built_in">exit</span> 1</span><br><span class="line">                <span class="keyword">fi</span></span><br><span class="line">                ;;</span><br><span class="line">            -e|--end)</span><br><span class="line">                <span class="keyword">if</span> [[ ! -z <span class="variable">$2</span> ]] &amp;&amp; [[ <span class="variable">$2</span> != -* ]];<span class="keyword">then</span></span><br><span class="line">                    frame_end=<span class="variable">$2</span></span><br><span class="line">                    <span class="built_in">shift</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    print_center <span class="string">&quot;Error: Missing end frame number&quot;</span></span><br><span class="line">                    <span class="built_in">exit</span> 1</span><br><span class="line">                <span class="keyword">fi</span></span><br><span class="line">                ;;</span><br><span class="line">            -c|--case_name)</span><br><span class="line">                <span class="keyword">if</span> [[ ! -z <span class="variable">$2</span> ]] &amp;&amp; [[ <span class="variable">$2</span> != -* ]];<span class="keyword">then</span></span><br><span class="line">                    case_name=<span class="variable">$2</span></span><br><span class="line">                    <span class="built_in">shift</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    print_center <span class="string">&quot;Error: Missing case name&quot;</span></span><br><span class="line">                    <span class="built_in">exit</span> 1</span><br><span class="line">                <span class="keyword">fi</span></span><br><span class="line">                ;;</span><br><span class="line">            -*|-h|--<span class="built_in">help</span>)</span><br><span class="line">                usage</span><br><span class="line">                <span class="built_in">exit</span> 0</span><br><span class="line">                ;;</span><br><span class="line">            *)</span><br><span class="line">                print_center <span class="string">&quot;Error: Invalid argument&quot;</span></span><br><span class="line">                usage</span><br><span class="line">                <span class="built_in">exit</span> 1</span><br><span class="line">                ;;</span><br><span class="line">        <span class="keyword">esac</span></span><br><span class="line">        <span class="built_in">shift</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$frame_start</span> -ne -1 ]] &amp;&amp; [[ <span class="variable">$frame_end</span> -eq -1 ]]; <span class="keyword">then</span></span><br><span class="line">        frame_end=<span class="variable">$frame_start</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    print_center <span class="string">&quot;Command line options parsed successfully. Start Frame: <span class="variable">$&#123;frame_start&#125;</span>, End Frame: <span class="variable">$&#123;frame_end&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">run_python_script_and_process_files</span></span>() &#123;</span><br><span class="line">    print_center <span class="string">&quot;Running Python script for frame ID: <span class="variable">$&#123;frame_id&#125;</span>...&quot;</span></span><br><span class="line">    python_script=<span class="string">&quot;<span class="variable">$&#123;python_dir&#125;</span>/rotate_dxm.py&quot;</span></span><br><span class="line">    python_command=<span class="string">&quot;python <span class="variable">$&#123;python_script&#125;</span> -f <span class="variable">$&#123;frame_id&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="variable">$&#123;python_command&#125;</span>; <span class="keyword">then</span></span><br><span class="line">        print_center <span class="string">&quot;Python script executed successfully.&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        print_center <span class="string">&quot;Failed to execute Python script.&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    print_center <span class="string">&quot;Copying generated NHWC bin files to golden test directory...&quot;</span></span><br><span class="line">    <span class="built_in">local</span> input_src=<span class="string">&quot;<span class="variable">$&#123;python_dir&#125;</span>/data_pytorch/<span class="variable">$&#123;input_target_name&#125;</span>.bin&quot;</span></span><br><span class="line">    <span class="built_in">local</span> output_src=<span class="string">&quot;<span class="variable">$&#123;python_dir&#125;</span>/data_pytorch/<span class="variable">$&#123;output_target_name&#125;</span>.bin&quot;</span></span><br><span class="line">    <span class="built_in">local</span> input_dst=<span class="string">&quot;<span class="variable">$&#123;golden_test_dir&#125;</span>/<span class="variable">$&#123;input_target_name&#125;</span>.bin&quot;</span></span><br><span class="line">    <span class="built_in">local</span> output_dst=<span class="string">&quot;<span class="variable">$&#123;golden_test_dir&#125;</span>/<span class="variable">$&#123;output_target_name&#125;</span>.bin&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">local</span> md5_file_src=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;input_src&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    <span class="built_in">local</span> path_file_src=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;input_src&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    print_center <span class="string">&quot;MD5 for input src file: <span class="variable">$&#123;md5_file_src&#125;</span>&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;path for input src file: <span class="variable">$&#123;path_file_src&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">cp</span> <span class="string">&quot;<span class="variable">$&#123;input_src&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;input_dst&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">local</span> md5_file_dst=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;input_dst&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    <span class="built_in">local</span> path_file_dst=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;input_dst&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    print_center <span class="string">&quot;MD5 for input dst file: <span class="variable">$&#123;md5_file_dst&#125;</span>&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;path for input dst file: <span class="variable">$&#123;path_file_dst&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    md5_file_src=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;output_src&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    path_file_src=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;output_src&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    print_center <span class="string">&quot;MD5 for output src file: <span class="variable">$&#123;md5_file_src&#125;</span>&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;path for output src file: <span class="variable">$&#123;path_file_src&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">cp</span> <span class="string">&quot;<span class="variable">$&#123;output_src&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;output_dst&#125;</span>&quot;</span></span><br><span class="line">    md5_file_dst=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;output_dst&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    path_file_dst=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;output_dst&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    print_center <span class="string">&quot;MD5 for output dst file: <span class="variable">$&#123;md5_file_dst&#125;</span>&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;path for output dst file: <span class="variable">$&#123;path_file_dst&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">update_cmake_and_related_files</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;include(\$&#123;GOLDEN_ROOT&#125;/<span class="variable">$&#123;case_name&#125;</span>/CMakeLists.txt)&quot;</span> &gt; <span class="string">&quot;<span class="variable">$target_cmakelists</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> grep -q <span class="string">&quot;<span class="variable">$input_original_name</span>&quot;</span> <span class="string">&quot;<span class="variable">$cmake_file_path</span>&quot;</span>; <span class="keyword">then</span></span><br><span class="line">        sed -i <span class="string">&quot;s/<span class="variable">$input_original_name</span>/<span class="variable">$&#123;input_target_name&#125;</span>/g&quot;</span> <span class="string">&quot;<span class="variable">$cmake_file_path</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sed -i <span class="string">&quot;s/rotate_nearest_pytorch_frame[0-9]*_input_nhwc/<span class="variable">$&#123;input_target_name&#125;</span>/g&quot;</span> <span class="string">&quot;<span class="variable">$cmake_file_path</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> grep -q <span class="string">&quot;<span class="variable">$output_original_name</span>&quot;</span> <span class="string">&quot;<span class="variable">$cmake_file_path</span>&quot;</span>; <span class="keyword">then</span></span><br><span class="line">        sed -i <span class="string">&quot;s/<span class="variable">$output_original_name</span>/<span class="variable">$&#123;output_target_name&#125;</span>/g&quot;</span> <span class="string">&quot;<span class="variable">$cmake_file_path</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sed -i <span class="string">&quot;s/rotate_nearest_pytorch_frame[0-9]*_output_nhwc/<span class="variable">$&#123;output_target_name&#125;</span>/g&quot;</span> <span class="string">&quot;<span class="variable">$cmake_file_path</span>&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    angle_value=$(python read_angle.py <span class="string">&quot;<span class="variable">$&#123;angle_bin_path&#125;</span>&quot;</span>)</span><br><span class="line">    sed -i <span class="string">&quot;s/#define ANGLE .*/#define ANGLE (<span class="variable">$&#123;angle_value&#125;</span>)/&quot;</span> <span class="string">&quot;<span class="variable">$&#123;rotate_h_path&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">compile_and_run_tests</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> runtime_log=<span class="string">&quot;<span class="variable">$&#123;runtime_dir&#125;</span>/runtime_frame<span class="variable">$&#123;frame_id&#125;</span>.log&quot;</span></span><br><span class="line">    <span class="built_in">local</span> fm_log=<span class="string">&quot;<span class="variable">$&#123;runtime_dir&#125;</span>/fm_frame<span class="variable">$&#123;frame_id&#125;</span>.log&quot;</span></span><br><span class="line">    </span><br><span class="line">    print_center <span class="string">&quot;Compiling runtime environment. Logs can be found in <span class="variable">$&#123;runtime_log&#125;</span>&quot;</span></span><br><span class="line">    (<span class="built_in">cd</span> <span class="variable">$&#123;runtime_dir&#125;</span> &amp;&amp; ./build.sh fm) &gt; <span class="string">&quot;<span class="variable">$&#123;runtime_log&#125;</span>&quot;</span> 2&gt;&amp;1</span><br><span class="line">    </span><br><span class="line">    print_center <span class="string">&quot;Executing fm_d_smoke_test. Logs can be found in <span class="variable">$&#123;fm_log&#125;</span>&quot;</span></span><br><span class="line">    (<span class="variable">$&#123;fm_test_dir&#125;</span>/old_fm_d_smoke_test.bin <span class="variable">$&#123;runtime_dir&#125;</span>/builddir/<span class="variable">$&#123;case_name&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>.bin) &gt; <span class="string">&quot;<span class="variable">$&#123;fm_log&#125;</span>&quot;</span> 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">calculate_cosine_similarity</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> golden_file=<span class="string">&quot;<span class="variable">$&#123;golden_test_dir&#125;</span>/<span class="variable">$&#123;output_target_name&#125;</span>.bin&quot;</span></span><br><span class="line">    <span class="built_in">local</span> sample_file=<span class="string">&quot;<span class="variable">$&#123;sample_data_dir&#125;</span>/<span class="variable">$&#123;case_name&#125;</span>_out.bin&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">local</span> md5_file1=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;golden_file&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    <span class="built_in">local</span> md5_file2=$(<span class="built_in">md5sum</span> <span class="string">&quot;<span class="variable">$&#123;sample_file&#125;</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    print_center <span class="string">&quot;MD5 for golden: <span class="variable">$&#123;md5_file1&#125;</span>&quot;</span></span><br><span class="line">    print_center <span class="string">&quot;MD5 for sample: <span class="variable">$&#123;md5_file2&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$&#123;md5_file1&#125;</span>&quot;</span> == <span class="string">&quot;<span class="variable">$&#123;md5_file2&#125;</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        print_center <span class="string">&quot;Files are identical, proceeding to calculate cosine similarity.&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">local</span> cosine_script=<span class="string">&quot;<span class="variable">$&#123;python_dir&#125;</span>/cosine_similarity.py&quot;</span></span><br><span class="line">        python <span class="string">&quot;<span class="variable">$&#123;cosine_script&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;golden_file&#125;</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;sample_file&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        print_center <span class="string">&quot;Files differ, exiting.&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">    initialize</span><br><span class="line">    parse_options <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$frame_start</span> -eq -1 ]]; <span class="keyword">then</span></span><br><span class="line">        print_center <span class="string">&quot;Error: No frame specified to process.&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> frame <span class="keyword">in</span> $(<span class="built_in">seq</span> <span class="variable">$frame_start</span> <span class="variable">$frame_end</span>); <span class="keyword">do</span></span><br><span class="line">        frame_id=<span class="variable">$frame</span></span><br><span class="line">        print_center <span class="string">&quot;Processing frame <span class="variable">$&#123;frame_id&#125;</span>...&quot;</span></span><br><span class="line"></span><br><span class="line">        config</span><br><span class="line">        run_python_script_and_process_files</span><br><span class="line">        update_cmake_and_related_files</span><br><span class="line">        compile_and_run_tests</span><br><span class="line">        calculate_cosine_similarity</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure>





<h4 id="python-script"><a href="#python-script" class="headerlink" title="python_script"></a>python_script</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics.pairwise <span class="keyword">import</span> cosine_similarity</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置打印选项</span></span><br><span class="line">np.set_printoptions(linewidth=<span class="number">400</span>)</span><br><span class="line">torch.set_printoptions(linewidth=<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置参数</span></span><br><span class="line">ENABLE_FP8_DATA_TYPE = <span class="literal">True</span></span><br><span class="line">ENABLE_OUTPUT_BINARY = <span class="literal">True</span></span><br><span class="line">ENABLE_PRINT = <span class="literal">True</span></span><br><span class="line">ENABLE_NHWC_2_NCHW = <span class="literal">True</span></span><br><span class="line">INTERPOLATE_MODE = <span class="string">&quot;nearest&quot;</span></span><br><span class="line">N, C, H, W = <span class="number">32</span>, <span class="number">8</span>, <span class="number">400</span>, <span class="number">200</span>  <span class="comment"># tile_num, Channels, Height, Width</span></span><br><span class="line">center = (W/<span class="number">2</span>, H/<span class="number">2</span>)</span><br><span class="line">DATA_PATH = <span class="string">&quot;/home/dugen/scc_dxm/project_dxm/golden_data/rotate&quot;</span></span><br><span class="line">dtype = np.uint8 <span class="keyword">if</span> ENABLE_FP8_DATA_TYPE <span class="keyword">else</span> np.int8</span><br><span class="line">interpolation_mode = torchvision.transforms.InterpolationMode.NEAREST</span><br><span class="line"></span><br><span class="line"><span class="comment"># 居中打印</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_centered</span>(<span class="params">text</span>):</span><br><span class="line">    terminal_size = os.get_terminal_size().columns</span><br><span class="line">    <span class="built_in">print</span>(text.center(terminal_size))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_args</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;Process one or more frames.&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-f&#x27;</span>, <span class="string">&#x27;--frame&#x27;</span>, nargs=<span class="string">&#x27;+&#x27;</span>, dest=<span class="string">&#x27;frame_ids&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Frame ID(s) to process.&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取二进制文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_bin_file</span>(<span class="params">file_path, dtype</span>):</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(file_path):</span><br><span class="line">        <span class="keyword">return</span> np.fromfile(file_path, dtype=dtype)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print_centered(<span class="string">&quot;File does not exist:&quot;</span>, file_path)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取角度值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_angle_from_bin_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(file_path):</span><br><span class="line">        print_centered(<span class="string">&quot;Angle file does not exist:&quot;</span>, file_path)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>, <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        angle_fp64 = np.fromfile(file_path, dtype=np.float32)[<span class="number">0</span>]</span><br><span class="line">        angle_fp32 = <span class="built_in">float</span>(angle_fp64)</span><br><span class="line">    <span class="keyword">return</span> angle_fp32, angle_fp64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform_and_save</span>(<span class="params">data, original_layout, N, H, W, C, filename_prefix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    此函数将保存的文件路径修改为脚本所在目录的data_pytorch子目录。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    save_dir = os.path.join(os.path.dirname(os.path.abspath(__file__)), <span class="string">&#x27;data_pytorch&#x27;</span>)</span><br><span class="line">    os.makedirs(save_dir, exist_ok=<span class="literal">True</span>)  <span class="comment"># 确保目录存在</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> original_layout == <span class="string">&#x27;NCHW&#x27;</span>:</span><br><span class="line">        tensor = torch.from_numpy(data.reshape(N, C, H, W))</span><br><span class="line">    <span class="keyword">elif</span> original_layout == <span class="string">&#x27;NHWC&#x27;</span>:</span><br><span class="line">        tensor = torch.from_numpy(data.reshape(N, H, W, C)).permute(<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Unsupported original layout. Expected &#x27;NCHW&#x27; or &#x27;NHWC&#x27;.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 文件保存路径调整</span></span><br><span class="line">    filename_nchw = os.path.join(save_dir, <span class="string">f&quot;rotate_<span class="subst">&#123;INTERPOLATE_MODE&#125;</span>_pytorch_<span class="subst">&#123;filename_prefix&#125;</span>_nchw.bin&quot;</span>)</span><br><span class="line">    tensor.numpy().tofile(filename_nchw)</span><br><span class="line">    print_centered(<span class="string">f&quot;Saved NCHW layout to <span class="subst">&#123;filename_nchw&#125;</span>, shape: <span class="subst">&#123;tensor.shape&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    tensor_nhwc = tensor.permute(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">    filename_nhwc = os.path.join(save_dir, <span class="string">f&quot;rotate_<span class="subst">&#123;INTERPOLATE_MODE&#125;</span>_pytorch_<span class="subst">&#123;filename_prefix&#125;</span>_nhwc.bin&quot;</span>)</span><br><span class="line">    tensor_nhwc.numpy().tofile(filename_nhwc)</span><br><span class="line">    print_centered(<span class="string">f&quot;Saved NHWC layout to <span class="subst">&#123;filename_nhwc&#125;</span>, shape: <span class="subst">&#123;tensor_nhwc.shape&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tensor余弦相似度与MSE比较</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tensor_cosine_similarity</span>(<span class="params">tensor_a, tensor_b, thd=<span class="number">0.999</span></span>):</span><br><span class="line">    tensor_a = tensor_a.numpy().reshape(<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line">    tensor_b = tensor_b.numpy().reshape(<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cos_sim = cosine_similarity(tensor_a, tensor_b)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">        mse = mean_squared_error(tensor_a, tensor_b)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print_centered(<span class="string">f&quot;Error calculating metrics: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&#x27;pass&#x27;</span> <span class="keyword">if</span> cos_sim &gt; thd <span class="keyword">else</span> <span class="string">&#x27;fail&#x27;</span></span><br><span class="line">    print_centered(<span class="string">f&quot;Cosine similarity: <span class="subst">&#123;cos_sim&#125;</span>, Mean square error: <span class="subst">&#123;mse&#125;</span>, Test result: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> result == <span class="string">&#x27;pass&#x27;</span> <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_manual</span>(<span class="params">images_nchw, angle, interpolation_mode, center</span>):</span><br><span class="line">    N, C, H, W = images_nchw.shape</span><br><span class="line">    x_c, y_c = center[<span class="number">0</span>] - <span class="number">0.5</span>, center[<span class="number">1</span>] - <span class="number">0.5</span></span><br><span class="line">    angle_rad = math.radians(angle)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算 cos 和 sin 的值</span></span><br><span class="line">    cos_theta = math.cos(angle_rad)</span><br><span class="line">    sin_theta = math.sin(angle_rad)</span><br><span class="line">    x_center = x_c - x_c * cos_theta + y_c * sin_theta</span><br><span class="line">    y_center = y_c - x_c * sin_theta - y_c * cos_theta</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建一个与输入相同形状的张量来存储旋转后的图像</span></span><br><span class="line">    rotated_images_nchw_optimized = torch.zeros_like(images_nchw)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建网格</span></span><br><span class="line">    y_grid, x_grid = torch.meshgrid(torch.arange(H), torch.arange(W), indexing=<span class="string">&#x27;ij&#x27;</span>)  </span><br><span class="line">    y_grid = y_grid.<span class="built_in">float</span>()</span><br><span class="line">    x_grid = x_grid.<span class="built_in">float</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算旋转后的位置</span></span><br><span class="line">    y_i = x_grid * sin_theta + y_grid * cos_theta + y_center</span><br><span class="line">    x_i = x_grid * cos_theta - y_grid * sin_theta + x_center</span><br><span class="line">    a1 = y_i</span><br><span class="line">    b1 = x_i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将新位置的值赋给输出张量的对应位置</span></span><br><span class="line">    x_ir = torch.<span class="built_in">round</span>(x_i).long()</span><br><span class="line">    y_ir = torch.<span class="built_in">round</span>(y_i).long()</span><br><span class="line"></span><br><span class="line">    x_i = torch.clamp(x_ir, <span class="number">0</span>, W-<span class="number">1</span>)</span><br><span class="line">    y_i = torch.clamp(y_ir, <span class="number">0</span>, H-<span class="number">1</span>)</span><br><span class="line">    mask = (x_ir &gt;= <span class="number">0</span>) &amp; (x_ir &lt; W) &amp; (y_ir &gt;= <span class="number">0</span>) &amp; (y_ir &lt; H)</span><br><span class="line"></span><br><span class="line">    rotated_images_nchw_optimized[:, :, mask] = images_nchw[:, :, y_i[mask], x_i[mask]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ENABLE_PRINT:</span><br><span class="line">        <span class="comment"># 在 c, h, w 维度进行打印</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(C):</span><br><span class="line">            <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(H):</span><br><span class="line">                <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(W):</span><br><span class="line">                    <span class="keyword">if</span> mask[h, w]:</span><br><span class="line">                        print_centered(<span class="string">f&quot;(c, y, x) = (<span class="subst">&#123;c&#125;</span>, <span class="subst">&#123;h&#125;</span>, <span class="subst">&#123;w&#125;</span>)\t(y_i, x_i) = (<span class="subst">&#123;a1[h, w]&#125;</span>, <span class="subst">&#123;b1[h, w]&#125;</span>)\t(round_yi, round_xi) = (<span class="subst">&#123;y_ir[h, w]&#125;</span>, <span class="subst">&#123;x_ir[h, w]&#125;</span>)\t(int_yi, int_xi) = (<span class="subst">&#123;y_i[h, w]&#125;</span>, <span class="subst">&#123;x_i[h, w]&#125;</span>)&quot;</span>)</span><br><span class="line">                        <span class="comment"># print_centered(f&quot;rotated_images_nchw_optimized[&#123;c&#125;, &#123;h&#125;, &#123;w&#125;] = &#123;rotated_images_nchw_optimized[c, h, w]&#125;&quot;)</span></span><br><span class="line">                        <span class="comment"># print_centered(f&quot;images_nchw[&#123;c&#125;, &#123;y_i[h, w]&#125;, &#123;x_i[h, w]&#125;] = &#123;images_nchw[c, y_i[h, w], x_i[h, w]]&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print_centered(<span class="string">f&quot;==================== default close rotate debug print func ====================\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rotated_images_nchw_optimized</span><br><span class="line"><span class="comment">##################################### PYTHON_MANUAL_ROTATE_FUNC #####################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    args = parse_args()</span><br><span class="line">    frame_ids = args.frame_ids  <span class="comment"># 这将是一个帧ID列表</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> frame_id <span class="keyword">in</span> frame_ids:</span><br><span class="line">        frame = <span class="string">f&quot;frame<span class="subst">&#123;frame_id&#125;</span>&quot;</span></span><br><span class="line">        print_centered(<span class="string">f&quot;Testing <span class="subst">&#123;frame&#125;</span>...&quot;</span>)</span><br><span class="line">        <span class="comment"># input_name = f&quot;&#123;DATA_PATH&#125;/&#123;frame&#125;/Input.prev_bev.1x256x400x200.fp8.bin&quot;</span></span><br><span class="line">        <span class="comment"># angle_name = f&quot;&#123;DATA_PATH&#125;/&#123;frame&#125;/Input.angle.fp64.bin&quot;</span></span><br><span class="line">        <span class="comment"># output_name = f&quot;&#123;DATA_PATH&#125;/&#123;frame&#125;/Golden.prev_bev_out.1x256x400x200.fp8.bin&quot;</span></span><br><span class="line"></span><br><span class="line">        input_name = <span class="string">f&quot;<span class="subst">&#123;DATA_PATH&#125;</span>/<span class="subst">&#123;frame&#125;</span>/Input.prev_bev.32x400x200x8.fp8.bin&quot;</span></span><br><span class="line">        angle_name = <span class="string">f&quot;<span class="subst">&#123;DATA_PATH&#125;</span>/<span class="subst">&#123;frame&#125;</span>/Input.angle.fp32.bin&quot;</span></span><br><span class="line">        output_name = <span class="string">f&quot;<span class="subst">&#123;DATA_PATH&#125;</span>/<span class="subst">&#123;frame&#125;</span>/Golden.prev_bev_out.32x400x200x8.fp8.bin&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 读取输入和输出数据</span></span><br><span class="line">        input_bin = read_bin_file(input_name, dtype)</span><br><span class="line">        output_bin = read_bin_file(output_name, dtype)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ENABLE_NHWC_2_NCHW:</span><br><span class="line">            original_layout = <span class="string">&#x27;NHWC&#x27;</span></span><br><span class="line">            input_tensor = torch.from_numpy(input_bin.reshape(N, H, W, C)).permute(<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">            output_tensor = torch.from_numpy(output_bin.reshape(N, H, W, C)).permute(<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            original_layout = <span class="string">&#x27;NCHW&#x27;</span></span><br><span class="line">            input_tensor = torch.from_numpy(input_bin.reshape(N, C, H, W))</span><br><span class="line">            output_tensor = torch.from_numpy(output_bin.reshape(N, C, H, W))</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ENABLE_OUTPUT_BINARY:</span><br><span class="line">            output_tensor = rotate_manual(input_tensor, angle_fp32, interpolation_mode, center)</span><br><span class="line"></span><br><span class="line">        transform_and_save(input_bin, original_layout, N, H, W, C, <span class="string">f&#x27;<span class="subst">&#123;frame&#125;</span>_input&#x27;</span>)</span><br><span class="line">        transform_and_save(output_bin, original_layout, N, H, W, C, <span class="string">f&#x27;<span class="subst">&#123;frame&#125;</span>_output&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 读取角度</span></span><br><span class="line">        angle_fp32, angle_fp64 = read_angle_from_bin_file(angle_name) <span class="keyword">if</span> os.path.exists(angle_name) <span class="keyword">else</span> (<span class="number">0.0</span>, <span class="number">0.0</span>)</span><br><span class="line">        print_centered(<span class="string">f&quot;[<span class="subst">&#123;frame&#125;</span>] angle (fp64): <span class="subst">&#123;angle_fp64:<span class="number">.9</span>f&#125;</span>&quot;</span>)</span><br><span class="line">        print_centered(<span class="string">f&quot;[<span class="subst">&#123;frame&#125;</span>] angle (fp32): <span class="subst">&#123;angle_fp32:<span class="number">.9</span>f&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        rotated_pytorch_tensor = torchvision.transforms.functional.rotate(</span><br><span class="line">            input_tensor, angle=angle_fp32, interpolation=interpolation_mode, center=center)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 比较结果</span></span><br><span class="line">        comparison_result = tensor_cosine_similarity(rotated_pytorch_tensor, output_tensor)</span><br><span class="line">        print_centered(<span class="string">f&quot;[<span class="subst">&#123;frame&#125;</span>] Comparison result: <span class="subst">&#123;<span class="string">&#x27;Pass&#x27;</span> <span class="keyword">if</span> comparison_result <span class="keyword">else</span> <span class="string">&#x27;Fail&#x27;</span>&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><h2 id="gitlab"><a href="#gitlab" class="headerlink" title="gitlab"></a>gitlab</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">git init                           <span class="comment"># 初始化git仓库</span></span><br><span class="line">git <span class="built_in">clone</span> &lt;repository_url&gt;         <span class="comment"># 克隆远程仓库</span></span><br><span class="line">git checkout -b &lt;branch_name&gt;      <span class="comment"># 创建一个新的分支</span></span><br><span class="line">git add .                          <span class="comment"># 添加文件到暂存区</span></span><br><span class="line">git commit -m <span class="string">&quot;&lt;your_message&gt;&quot;</span>     <span class="comment"># 提交更改到本地仓库</span></span><br><span class="line">git push origin rotate_local:rotate_remote    <span class="comment"># 推送该分支到远程仓库并指定名称为rotate_remote</span></span><br><span class="line">git branch --set-upstream-to=origin/rotate_remote rotate_local    <span class="comment"># 绑定local与remote分支</span></span><br><span class="line">git branch -u origin/rotate_remote rotate_local                   <span class="comment"># 简写</span></span><br><span class="line">git push origin rotate_remote      <span class="comment"># 推送更改到远程分支</span></span><br><span class="line">git pull origin master             <span class="comment"># 拉取远程仓库的最新更改</span></span><br><span class="line">git checkout master</span><br><span class="line">git merge &lt;branch_name&gt;            <span class="comment"># 将feature合入master</span></span><br><span class="line">git branch -d &lt;branch_name&gt;        <span class="comment"># 删除分支</span></span><br><span class="line">git push origin --delete rotate    <span class="comment"># 删除origin的远程仓库中的rotate分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># demo001</span></span><br><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;dxm_first_blog&quot;</span></span><br><span class="line">git remote add origin git@github.com:dxm2301/blog_ddd.git</span><br><span class="line">git remote set-url origin git@github.com:dxm2301/blog_ddd.git</span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>




<h2 id="girret"><a href="#girret" class="headerlink" title="girret"></a>girret</h2><h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="software-install"><a href="#software-install" class="headerlink" title="software install"></a>software install</h2><h3 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ./package_file.deb	<span class="comment"># apt安装deb包</span></span><br></pre></td></tr></table></figure>

<h3 id="aptitude"><a href="#aptitude" class="headerlink" title="aptitude"></a>aptitude</h3><h3 id="dpkg"><a href="#dpkg" class="headerlink" title="dpkg"></a>dpkg</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg -i package_file.deb	<span class="comment"># dpkg安装deb包</span></span><br></pre></td></tr></table></figure>

<h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf dxm.tar.gz</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-x</code>：解压文件；</li>
<li><code>-z</code>：待解压文件是用 gzip 压缩；</li>
<li><code>-v</code>：解压过程中显示文件名；</li>
<li><code>-f</code>：待解压文件名；</li>
</ul>
<h2 id="tree"><a href="#tree" class="headerlink" title="tree"></a>tree</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tree -L 2 -af path/to/directory</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-L 2</code>：指定要显示的树的最大深度；</li>
<li><code>-a</code>：显示所有文件和目录，包括隐藏的文件和目录；</li>
<li><code>-f</code>：打印每个文件的完整路径前缀；</li>
<li><code>path/to/directory</code>：显示树结构的目录路径；</li>
</ul>
<h2 id="批量改名"><a href="#批量改名" class="headerlink" title="批量改名"></a>批量改名</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename <span class="string">&#x27;s/MH20/MH20_1slice/&#x27;</span> MH20_Resize_Conv_16tiles_1slice_int8*.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>


<h2 id="scp-sftp"><a href="#scp-sftp" class="headerlink" title="scp&#x2F;sftp"></a>scp&#x2F;sftp</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sftp lixiang@10.243.120.94    <span class="comment"># 输入密码</span></span><br><span class="line"><span class="comment"># ls查看远程服务器目录，lls查看本地服务器目录</span></span><br><span class="line">lcd /home/dugen/scc_dxm/directory    <span class="comment"># 更改本地目录到要包含复制文件的目录</span></span><br><span class="line">put file.txt                         <span class="comment"># 使用put命令将文件从本地复制到远程服务器</span></span><br><span class="line"><span class="built_in">ls</span>                                   <span class="comment"># 使用ls确认成功复制到远程服务器</span></span><br></pre></td></tr></table></figure>

      <div class="tags">
          <a href="/tags/Linux/" rel="tag"><i class="ic i-tag"></i> Linux</a>
          <a href="/tags/Vim/" rel="tag"><i class="ic i-tag"></i> Vim</a>
          <a href="/tags/GDB/" rel="tag"><i class="ic i-tag"></i> GDB</a>
          <a href="/tags/Git/" rel="tag"><i class="ic i-tag"></i> Git</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2024-05-06 21:23:20" itemprop="dateModified" datetime="2024-05-06T21:23:20+08:00">2024-05-06</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="dxm WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="dxm Alipay">
        <p>Alipay</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>dxm <i class="ic i-at"><em>@</em></i>blog_dxm
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://example.com/2024/04/25/note/tutorial_linux/" title="Tutorial-Linux">http://example.com/2024/04/25/note/tutorial_linux/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/04/25/job/operator/rotate/" itemprop="url" rel="prev" data-background-image="&#x2F;2024&#x2F;04&#x2F;25&#x2F;job&#x2F;operator&#x2F;rotate&#x2F;rs_0001.png" title="Rotate">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> 算子开发</span>
  <h3>Rotate</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/05/06/job/compile/mlir/" itemprop="url" rel="next" data-background-image="&#x2F;2024&#x2F;05&#x2F;06&#x2F;job&#x2F;compile&#x2F;mlir&#x2F;wp_0008.jpg" title="MLIR学习">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> Compile</span>
  <h3>MLIR学习</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Vim"><span class="toc-number">1.</span> <span class="toc-text">Vim</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%AE%E4%BD%8D%E5%9B%BE"><span class="toc-number">1.1.</span> <span class="toc-text">键位图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vim%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD"><span class="toc-number">1.2.</span> <span class="toc-text">vim常用功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%89%E6%A0%87%E7%A7%BB%E5%8A%A8%E3%80%81%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4%E3%80%81%E6%90%9C%E7%B4%A2%E6%9B%BF%E6%8D%A2"><span class="toc-number">1.2.1.</span> <span class="toc-text">光标移动、复制粘贴、搜索替换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%89%E6%A0%87%E7%A7%BB%E5%8A%A8"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">光标移动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E6%9B%BF%E6%8D%A2"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">搜索替换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">删除复制粘贴</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">编辑模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#plug-in"><span class="toc-number">1.3.</span> <span class="toc-text">plug-in</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A%E6%8F%92%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">注释插件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-number">2.</span> <span class="toc-text">文本处理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#grep"><span class="toc-number">2.1.</span> <span class="toc-text">grep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk"><span class="toc-number">2.2.</span> <span class="toc-text">awk</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.2.1.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#accuracy-mismatch"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">accuracy_mismatch</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sv-log"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">sv_log</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sed"><span class="toc-number">2.3.</span> <span class="toc-text">sed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#others"><span class="toc-number">2.4.</span> <span class="toc-text">others</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#shell-script"><span class="toc-number">3.</span> <span class="toc-text">shell script</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">基础语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dxm-cf-sh"><span class="toc-number">3.1.1.</span> <span class="toc-text">dxm_cf.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dxm-vdk-sh"><span class="toc-number">3.1.2.</span> <span class="toc-text">dxm_vdk.sh</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#shell-script-1"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">shell_script</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python-script"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">python_script</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Git"><span class="toc-number">4.</span> <span class="toc-text">Git</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#github"><span class="toc-number">4.1.</span> <span class="toc-text">github</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gitlab"><span class="toc-number">4.2.</span> <span class="toc-text">gitlab</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#girret"><span class="toc-number">4.3.</span> <span class="toc-text">girret</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#software-install"><span class="toc-number">5.1.</span> <span class="toc-text">software install</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#apt"><span class="toc-number">5.1.1.</span> <span class="toc-text">apt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#aptitude"><span class="toc-number">5.1.2.</span> <span class="toc-text">aptitude</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dpkg"><span class="toc-number">5.1.3.</span> <span class="toc-text">dpkg</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tar"><span class="toc-number">5.2.</span> <span class="toc-text">tar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tree"><span class="toc-number">5.3.</span> <span class="toc-text">tree</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E6%94%B9%E5%90%8D"><span class="toc-number">5.4.</span> <span class="toc-text">批量改名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scp-sftp"><span class="toc-number">5.5.</span> <span class="toc-text">scp&#x2F;sftp</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
        <ul>
          <li class="active"><a href="/2024/04/25/note/tutorial_linux/" rel="bookmark" title="Tutorial-Linux">Tutorial-Linux</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="dxm"
      data-src="/images/dxm.jpg">
  <p class="name" itemprop="name">dxm</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">11</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">10</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">15</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-github"></i></span>
      <span class="exturl item email" data-url="aHR0cHM6Ly9tYWlsLnFxLmNvbS9jZ2ktYmluL2ZyYW1lX2h0bWw/c2lkPWZremlPMlBjUWxSd01WUXkmcj04ODZkNjY5YmE3Yjg1MjAyNTk5NWIyZjQ1YmEzY2VmYSZsYW5nPXpo" title="https:&#x2F;&#x2F;mail.qq.com&#x2F;cgi-bin&#x2F;frame_html?sid&#x3D;fkziO2PcQlRwMVQy&amp;r&#x3D;886d669ba7b852025995b2f45ba3cefa&amp;lang&#x3D;zh"><i class="ic i-envelope"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL2hvdA==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;hot"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvbXkvbS9tdXNpYy9wbGF5bGlzdD9pZD00MDgyMTkzNTQ=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;my&#x2F;m&#x2F;music&#x2F;playlist?id&#x3D;408219354"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item bilibili" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tLw==" title="https:&#x2F;&#x2F;www.bilibili.com&#x2F;"><i class="ic i-bilibili"></i></span>
      <span class="exturl item youtube" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20v" title="https:&#x2F;&#x2F;www.youtube.com&#x2F;"><i class="ic i-youtube"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

    
  <li class="item">
    <a href="/resume/" rel="section"><i class="ic i-user"></i>resume</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/gallery/" rel="section"><i class="ic i-heart"></i>gallery</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-link-alt"></i>links</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/postgraduate/" rel="section"><i class="ic i-pen"></i>postgraduate</a>
  </li>

        
  <li class="item">
    <a href="/%E5%85%B4%E8%B6%A3/" rel="section"><i class="ic i-flag"></i>兴趣</a>
  </li>

        
  <li class="item">
    <a href="/%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7/" rel="section"><i class="ic i-edge"></i>在线工具</a>
  </li>

        
  <li class="item">
    <a href="/%E5%B7%A5%E4%BD%9C/" rel="section"><i class="ic i-coffee"></i>工作</a>
  </li>

        
  <li class="item">
    <a href="/%E8%AE%B0%E5%BF%86%E9%95%BF%E5%BB%8A/" rel="section"><i class="ic i-sakura"></i>记忆长廊</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/04/25/job/operator/rotate/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/05/06/job/compile/mlir/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Blog/" title="In Blog">Blog</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/" title="In Hexo">Hexo</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/Theme-Shoka-Documentation/" title="In Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/2020/08/13/note/theme-shoka-doc/config/" title="Step.2 基本配置">Step.2 基本配置</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Blog/" title="In Blog">Blog</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/" title="In Hexo">Hexo</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/Theme-Shoka-Documentation/" title="In Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/2020/08/13/note/theme-shoka-doc/display/" title="Step.3 界面显示">Step.3 界面显示</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/job/" title="In Job">Job</a>
<i class="ic i-angle-right"></i>
<a href="/categories/job/%E7%AE%97%E5%AD%90%E5%BC%80%E5%8F%91/" title="In 算子开发">算子开发</a>
</div>

    <span><a href="/2024/04/25/job/operator/convTranspose2d/" title="ConvTranspose2d">ConvTranspose2d</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/job/" title="In Job">Job</a>
<i class="ic i-angle-right"></i>
<a href="/categories/job/%E7%AE%97%E5%AD%90%E5%BC%80%E5%8F%91/" title="In 算子开发">算子开发</a>
</div>

    <span><a href="/2024/04/25/job/operator/rotate/" title="Rotate">Rotate</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/gallery/" title="In Gallery">Gallery</a>
<i class="ic i-angle-right"></i>
<a href="/categories/gallery/Wallpaper/" title="In Wallpaper">Wallpaper</a>
</div>

    <span><a href="/2024/04/18/gallery/wallpaper/" title="Wallpaper">Wallpaper</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Blog/" title="In Blog">Blog</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/" title="In Hexo">Hexo</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/Theme-Shoka-Documentation/" title="In Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/2020/08/13/note/theme-shoka-doc/special/" title="Step.4 主题特殊功能">Step.4 主题特殊功能</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/note/" title="In Note">Note</a>
</div>

    <span><a href="/2024/04/16/note/recording/" title="Recording-Blog">Recording-Blog</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Blog/" title="In Blog">Blog</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/" title="In Hexo">Hexo</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/Theme-Shoka-Documentation/" title="In Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/2020/08/13/note/theme-shoka-doc/dependents/" title="Step.1 依赖插件">Step.1 依赖插件</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Blog/" title="In Blog">Blog</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/" title="In Hexo">Hexo</a>
<i class="ic i-angle-right"></i>
<a href="/categories/Blog/Hexo/Theme-Shoka-Documentation/" title="In Theme Shoka Documentation">Theme Shoka Documentation</a>
</div>

    <span><a href="/2020/08/13/note/theme-shoka-doc/theme-shoka-doc/" title="Hexo主题Shoka &amp; multi-markdown-it渲染器使用说明">Hexo主题Shoka & multi-markdown-it渲染器使用说明</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/job/" title="In Job">Job</a>
<i class="ic i-angle-right"></i>
<a href="/categories/job/Compile/" title="In Compile">Compile</a>
</div>

    <span><a href="/2024/05/06/job/compile/mlir/" title="MLIR学习">MLIR学习</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">dxm @ DDD</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="Symbols count total">110k words</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="Reading time total">1:40</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/04/25/note/tutorial_linux/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
